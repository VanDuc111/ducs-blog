---
import BaseHead from "../components/BaseHead.astro";
import Footer from "../components/Footer.astro";
import Header from "../components/Header.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../consts";
import { getCollection } from "astro:content";
import FormattedDate from "../components/FormattedDate.astro";

const posts = (await getCollection("blog"))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 5);
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <body>
    <Header />
    <main class="content-container py-20">
      <!-- Intro Section -->
      <section class="mb-16">
        <h1 class="text-6xl md:text-7xl mb-8 tracking-tighter">
          {SITE_TITLE}
        </h1>
        <p class="text-xl text-slate-400 max-w-xl leading-relaxed">
          {SITE_DESCRIPTION}
        </p>
      </section>

      <div class="separator mb-16"></div>

      <!-- Minimal Post List -->
      <section>
        <h2
          class="text-xs uppercase tracking-[0.3em] text-cyan-400 mb-10 font-bold"
        >
          Mới nhất
        </h2>
        <div class="space-y-0">
          {
            posts.map((post) => (
              <a
                href={`/blog/${post.id}/`}
                class="card-minimal block group border-white/5"
              >
                <div class="flex flex-col md:flex-row md:items-baseline md:justify-between gap-4">
                  <h3 class="text-2xl group-hover:text-blue-400 transition-all tracking-tight">
                    {post.data.title}
                  </h3>
                  <div class="text-sm text-slate-500 font-mono whitespace-nowrap opacity-60">
                    <FormattedDate date={post.data.pubDate} />
                  </div>
                </div>
                <p class="text-slate-500 mt-4 line-clamp-2 max-w-xl text-base leading-relaxed">
                  {post.data.description}
                </p>
              </a>
            ))
          }
        </div>
        <div class="mt-20">
          <a
            href="/blog"
            class="group text-cyan-400 hover:text-cyan-300 font-medium pb-2 border-b border-cyan-500/30 hover:border-cyan-400 transition-all"
          >
            Tất cả bài viết <span
              class="group-hover:translate-x-1 inline-block transition-transform"
              >&rarr;</span
            >
          </a>
        </div>
      </section>
    </main>
    <Footer />
  </body>
</html>
